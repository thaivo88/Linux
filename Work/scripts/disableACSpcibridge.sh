#!/bin/bash
#
################################################
# Disable ACS on PCI bridge for A6500 Gen10 Plus
#
# DO NOT RUN THIS ON ANY OTHER SYSTEM AS THE BUS
# LOCATION ARE DIFFERENT ON DIFFERENT SYSTEM.
#
#*** ONLY FOR A6500 Gen10 Plus XL675d Tusken ***
#
# Owner: thai.vo@hpe.com
################################################
#
array=( 00:01.1 00:07.1 00:08.1 03:00.0 04:00.0 04:01.0 04:02.0 04:03.0 04:04.0 05:00.0 06:00.0 06:1f.0 09:00.0 0a:00.0 20:01.1 20:01.2 20:01.3 20:01.4 20:07.1 20:08.1 40:01.1 40:07.1 40:08.1 43:00.0 44:00.0 44:01.0 44:02.0 44:03.0 44:04.0 46:00.0 47:00.0 47:1f.0 4a:00.0 4b:00.0 60:03.1 60:05.2 60:07.1 60:08.1 80:01.1 80:07.1 80:08.1 83:00.0 84:00.0 84:01.0 84:02.0 84:03.0 84:04.0 86:00.0 87:00.0 89:00.0 8a:00.0 8a:1f.0 a0:03.1 a0:07.1 a0:08.1 a3:00.0 a4:00.0 a4:01.0 a4:02.0 a5:00.0 a6:00.0 a7:00.0 a8:01.0 a8:02.0 a8:03.0 a8:04.0 a8:0b.0 a8:0c.0 c0:01.1 c0:03.1 c0:03.2 c0:03.3 c0:03.4 c0:07.1 c0:08.1 c3:00.0 c4:00.0 c4:01.0 c4:02.0 c4:03.0 c4:04.0 c6:00.0 c7:00.0 c9:00.0 ca:00.0 ca:1f.0 e0:07.1 e0:08.1 )
for i in "${array[@]}"
do
    echo "disabling $i PCI bridge"
    setpci -v -s $i f2a.w=0000
    echo "$i completed"
done
